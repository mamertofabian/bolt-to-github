Refactor implementation while keeping tests green for $ARGUMENTS:

1. Ensure all tests are passing
2. Identify code smells and duplication
3. Refactor incrementally, running tests after each change
4. Improve performance and readability
5. Add any missing edge case tests
6. Commit refactored code: "refactor: improve $ARGUMENTS implementation"

REFACTOR phase - improve code quality without breaking tests!
